(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[674],{5285:function(e,t,s){Promise.resolve().then(s.bind(s,3058))},3058:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var r=s(7437),a=s(2265),n=s(6334),i=s(5526);function l(){let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{c()},[]);let c=async()=>{let e=(0,i.B)(),{data:s}=await e.from("profiles").select("*, subscriptions(*)").order("created_at",{ascending:!1});s&&t(s.map(e=>{var t;return{...e,subscription:(null===(t=e.subscriptions)||void 0===t?void 0:t[0])||null}})),l(!1)},d=async(e,t)=>{let s=(0,i.B)();if(t)await s.from("subscriptions").update({status:"cancelled"}).eq("user_id",e).eq("status","active");else{let t=new Date,r=new Date(t);r.setMonth(r.getMonth()+1),await s.from("subscriptions").insert({user_id:e,started_at:t.toISOString(),expires_at:r.toISOString(),status:"active",amount:25e4})}c()},x=e.filter(e=>{var t;return(null===(t=e.subscription)||void 0===t?void 0:t.status)==="active"}).length;return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"유저/구독 관리"}),(0,r.jsx)("p",{className:"text-gray-500",children:"회원 목록 및 구독 현황"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-5 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:e.length}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"전체 회원"})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-5 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:x}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"활성 구독"})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-5 text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-500",children:e.length-x}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"비구독"})]})]}),(0,r.jsx)("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden",children:s?(0,r.jsx)("div",{className:"p-8 text-center text-gray-400",children:"불러오는 중..."}):(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,r.jsx)("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"이름"}),(0,r.jsx)("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"이메일"}),(0,r.jsx)("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"역할"}),(0,r.jsx)("th",{className:"text-left px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"구독 상태"}),(0,r.jsx)("th",{className:"text-right px-6 py-3 text-xs font-medium text-gray-500 uppercase",children:"관리"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-gray-50",children:e.map(e=>{var t;let s=(null===(t=e.subscription)||void 0===t?void 0:t.status)==="active";return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4 font-medium text-gray-900",children:e.name||"—"}),(0,r.jsx)("td",{className:"px-6 py-4 text-gray-500 text-sm",children:e.email}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded ".concat("admin"===e.role?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-600"),children:"admin"===e.role?"관리자":"회원"})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 rounded-full ".concat(s?"bg-green-100 text-green-700":"bg-gray-100 text-gray-400"),children:s?"활성":"없음"})}),(0,r.jsx)("td",{className:"px-6 py-4 text-right",children:(0,r.jsx)(n.Z,{variant:s?"danger":"primary",size:"sm",onClick:()=>d(e.id,s),children:s?"구독 해제":"구독 부여"})})]},e.id)})})]})})]})}},6334:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(7437);function a(e){let{variant:t="primary",size:s="md",children:a,loading:n,className:i="",disabled:l,...c}=e;return(0,r.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-orange-500 hover:bg-orange-600 text-white",secondary:"bg-gray-100 hover:bg-gray-200 text-gray-900",danger:"bg-red-500 hover:bg-red-600 text-white",ghost:"hover:bg-gray-100 text-gray-600"}[t]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[s]," ").concat(i),disabled:l||n,...c,children:[n&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),a]})}},5526:function(e,t,s){"use strict";s.d(t,{B:function(){return a}});var r=s(4033);function a(){return(0,r.createBrowserClient)("https://your-project.supabase.co","your-anon-key")}s(257)}},function(e){e.O(0,[33,971,117,744],function(){return e(e.s=5285)}),_N_E=e.O()}]);